<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>プログラミング基礎 I: データの関連付け:
  ハッシュ</title>
  <meta name="generator" content="amaya 9.0, see http://www.w3.org/Amaya/" />
  <link href="../../stylesheets/slide-screen.css" rel="stylesheet"
  type="text/css" media="screen" />
  <link href="../../stylesheets/slide-proj.css" rel="stylesheet"
  type="text/css" media="projection" />
  <link href="../../stylesheets/slide-print.css" rel="stylesheet"
  type="text/css" media="print" />
  <style type="text/css">
  </style>
</head>

<body>
<h1 style="text-align: center">プログラミング基礎 I</h1>

<h2 style="text-align: center">第九回 (2005年 6月 20日):
データの関連付け: ハッシュ</h2>

<p style="text-align: center"><a
href="http://www.sw.it.aoyama.ac.jp/2005/Programming%20Basics%20I/lecture10.html"
style="margin-left: auto; margin-right: auto">http://www.sw.it.aoyama.ac.jp/2005/Programming%20Basics%20I/lecture10.html</a></p>

<p class="letterhead"><a href="http://www.aoyama.ac.jp/"><img alt="AGU"
src="../../stylesheets/aoyamalogo.jpg" /></a></p>

<p class="signature">© 2005 <a href="mailto:duerst@it.aoyama.ac.jp">Martin
J. Dürst</a> <a href="http://www.aoyama.ac.jp/">青山学院大学</a></p>

<h1>先先週の演習・宿題</h1>
<ul>
  <li>ローマ字表記を「ワープロ式」や訓令式からヘボン式へ変換するプログラムを作る
    (<a href="programs/hepburn.pl">解答例</a>)</li>
</ul>

<h1>配列の特性</h1>
<ul>
  <li>特長:
    <ul>
      <li>たくさんのデータを一緒に納められる</li>
      <li>指数 (番地) が分かればデータはすぐ見つかる</li>
    </ul>
  </li>
  <li>弱点:
    <ul>
      <li>指数 (<code>[]</code> 内) には数しか使えない</li>
      <li>指数が離れている場合にはメモリをたくさん取る</li>
      <li>何か探すときには全要素をチェックしないといけない</li>
    </ul>
  </li>
</ul>

<h1>ハッシュ (連想配列)</h1>
<ul>
  <li>「指数」(「番地」) は数とは限らない</li>
  <li>要素を一個参照するのが配列を全部辿るより速い</li>
  <li>配列はコンピュータのハードに近い;
    ハッシュは人間の記憶に近い</li>
</ul>

<h1>ハッシュの例: 月の番号と名前</h1>

<p>番号から名前を引く (配列使用):</p>

<p><code>$months[1] = "January";</code><br />
<code>...</code></p>

<p>名前から番号を引く (ハッシュ使用):</p>

<p><code>$months{'January'} = 1;</code><br />
<code>...</code></p>

<h1>ハッシュの書き方</h1>

<p>ハッシュ全体: <code>%hash</code><br />
(<code>%</code> はハッシュの「冠詞」でかる)</p>

<p>ハッシュの一個の要素: <code>$hash{'key'}</code><br />
(「単数」(スカラ) なので「冠詞」は <code>$</code>
に変更)<br />
(ハッシュの「番地」はキー (鍵) と言う)</p>

<p><code>$months</code> と <code>$months[$n]</code> と
<code>$months{$m}</code> は別物</p>

<p><code>$months</code> と <code>@months</code> と <code>%months</code>
は別物</p>

<h1>ハッシュとリスト</h1>

<p>リストをハッシュに変換する (例えば代入する)
時に、リストはキーと値の繰り返しと見なされる:</p>

<p><code>%months = ('January', 1, 'February', 2, 'March', 3, ...);</code></p>

<p>関連をもっとわかりやすくするには <code>=&gt;</code>
を使える:</p>

<p><code>%months = ('January' =&gt; 1, 'February' =&gt; 2, 'March' =&gt; 3,
...);</code></p>

<p>裸のワード (bareword) が使える:</p>

<p><code>%months = (January =&gt; 1, February =&gt; 2, March =&gt; 3,
...);</code></p>

<h1>ハッシュ全体の処理</h1>

<p>基本的な方法: <code>foreach</code> を使う:</p>
<ul>
  <li>キーを使う:<br />
    <code>foreach $key (keys %hash) { ... }</code></li>
  <li>キーを順番に辿る:<br />
    <code>foreach $key (sort keys %hash) { ... }</code></li>
  <li>値だけを使う:<br />
    <code>foreach $value (values %hash) { ... }</code></li>
</ul>

<h1>ハッシュの要素の存在</h1>

<p>存在のチェック:<br />
<code>if (defined $hash{"key"}) { ... }</code></p>

<p>完全な取消:<br />
<code>delete $hash{'key'};</code></p>

<p>値を無定義にするだけ:<br />
<code>undef $hash{'key'};</code></p>

<h1>二重ハッシュ等</h1>

<p>ハッシュと配列の要素の参照は二重以上使える:</p>
<ul>
  <li>二重ハッシュ:<br />
    <code>$BMI{'Konishiki'}{weight} = 250;</code></li>
  <li>ハッシュと配列:<br />
    <code>$months[6]{sales} = 150000; # 売り上げ<br />
    $monthlength[2]{leapyear} = 29; # 閏年</code></li>
  <li>二重配列も可能</li>
</ul>

<p>注意: 同じ変数名を使うには限界がある (例:
<code>$m[1]{xxx}</code> と <code>$m[1][5]</code>
は同時には使えない)</p>

<h1>演習</h1>
<ul>
  <li>月名のハッシュを作って、使う (日本語の旧月名
    (睦月など) とか外国語の月名を使う)</li>
  <li>BMI
    のデータのファイルを読み込んで、同じ人に複数の情報がある場合に警告を出す</li>
  <li>同じファイルを二重ハッシュに読み込んで、ある人だけの
    BMI を印刷する</li>
  <li>自分の身の回りのデータをハッシュに納めて、面白い計算・処理に使う</li>
</ul>
</body>
</html>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>第七回:
  文脈自由言語と構文解析・上向き構文解析と下向き構文解析</title>
  <meta name="generator" content="amaya 9.5, see http://www.w3.org/Amaya/" />
  <link href="../../stylesheets/slide-screen.css" rel="stylesheet"
  type="text/css" media="screen" />
  <link href="../../stylesheets/slide-proj.css" rel="stylesheet"
  type="text/css" media="projection" />
  <link href="../../stylesheets/slide-print.css" rel="stylesheet"
  type="text/css" media="print" />
  <style type="text/css" media="print">
    #traystack { height: 200px; width 250px; }
  </style>
</head>

<body>
<h1
style="text-align: center;"><strong>言語理論とコンパイラ</strong></h1>

<p style="text-align: center;"><strong>第七</strong><strong>回:</strong>
文脈自由言語と構文解析・上向き構文解析と下向き構文解析</p>

<p style="text-align: center;">2006 年 6月 9日</p>

<p style="text-align: center;"><a
href="http://www.sw.it.aoyama.ac.jp/2006/Compiler/lecture7.html">http://www.sw.it.aoyama.ac.jp/2006/Compiler/lecture7.html</a></p>

<p class="letterhead"><a href="http://www.aoyama.ac.jp/"><img alt="AGU"
src="../../stylesheets/aoyamalogo.jpg" /></a></p>

<p class="signature">© 2006 <a href="mailto:duerst@it.aoyama.ac.jp">Martin
J. Dürst</a> <a href="http://www.aoyama.ac.jp/">青山学院大学</a></p>

<h1>目次</h1>
<ul>
  <li>文脈自由文法</li>
  <li>プッシュダウンオートマトン</li>
  <li>解析木と構文木</li>
  <li>曖昧な文法</li>
</ul>

<h1>先週の宿題</h1>

<p>(提出不要)</p>
<ul>
  <li>C
    プログラム言語など知っている言語やデータ形式の文法を調べなさい。</li>
</ul>

<p>C プログラム言語の<a
href="http://kbs.cs.tu-berlin.de/~jutta/c/ANSI-C-grammar-y.html">文法の例</a>
(yacc 形式; <code>typedef</code> に要注意)</p>

<p>Java プログラム言語の<a
href="http://java.sun.com/docs/books/jls/second_edition/html/syntax.doc.html">文法</a>
(BNF 形式)</p>

<h1>先週のまとめ</h1>
<ul>
  <li>正規表現やそれと同等の表現力を持つツールには限界がある<br
    />
    (例: 括弧の入れ子構造など)</li>
  <li>正規表現などは構文解析には使えないが、字句解析には使える</li>
  <li>コンパイラで字句解析と構文解析に分けると分かりやすい構造になる</li>
  <li>更に、正規表現・有限オートマトンによって字句解析の速い実装が簡単に作れる</li>
</ul>

<h1>字句解析と構文解析</h1>

<table border="1">
  <tbody>
    <tr>
      <td></td>
      <td>字句解析</td>
      <td>構文解析</td>
    </tr>
    <tr>
      <td>解析対象</td>
      <td>定数、識別子、予約語、演算子など</td>
      <td>宣言、定義、式、文、関数など</td>
    </tr>
    <tr>
      <td>要点</td>
      <td>速さ</td>
      <td>能力</td>
    </tr>
    <tr>
      <td>記述方法</td>
      <td>正規表現</td>
      <td>文脈自由文法</td>
    </tr>
    <tr>
      <td>(自動) 解析手段</td>
      <td>有限オートマトン</td>
      <td>プッシュダウンオートマトン</td>
    </tr>
  </tbody>
</table>

<h1>正規文法と文脈自由文法</h1>

<p>正規文法 (regular grammar):</p>
<ul>
  <li>右線形文法か左線形文法</li>
</ul>

<p>文脈自由文法 (context free grammar):</p>
<ul>
  <li>文法の導出規則の左側は全て非終端記号一つ</li>
  <li>導出規則の右側は制限なし
    (非終端記号も終端記号も何個も使ってよい)</li>
  <li>例: A → aBb, B → aaB, S → aBaAb 等</li>
  <li>｢自由」の意味:
    依存しない、左右されない、関係ない</li>
  <li>プログラム言語の構文は周りが関係なくてその場で正しいかどう
    か判断できる</li>
  <li>(意味解析も含まれると文脈自由ではなくなる)</li>
</ul>

<h1>文脈自由文法の一例</h1>

<p>S → aSa | bSb | c</p>

<p>生成する言語: 真ん中に c が一個、周りに a と b が 0
以上対照的に自由な順番に並ぶ</p>

<p>生成する語の例: c, aca, bcb, abaabcbaaba 等</p>

<p>こういう風な言語を受理するのはメモリがないため有限オートマトンで
は不可能</p>

<p>オートマトンの機能拡張が必要</p>

<p>オートマトンにプッシュダウンスタックをつけよう</p>

<h1>プッシュダウンスタック</h1>
<ul>
  <li>受理する言語の記号と別のプッシュダウン記号を記憶できる</li>
  <li>一番上の記号しか見えない</li>
  <li>一番下に特別な記号 (ボトムマーカ) がある</li>
</ul>

<p></p>

<p><img
alt="A stack of trays at the cafeteria. Only the topmost tray is visible due to a built-in spring."
src="traystack.jpg" height="50%" width="50%" id="traystack" /></p>

<h1>プッシュダウンオートマトン</h1>
<ul>
  <li>遷移は入力記号だけではなくて、スタックの上に見える記号にも依存する</li>
  <li>遷移でのスタックについての動作:
    一番上のスタック記号を取るか、スタックをそのまま残すか、スタックに記号を追加するのか</li>
  <li>開始の時、ボトムマーカだけのスタック</li>
  <li>受理はボトムマーカだけのスタックや受理状態の時
    (複数の種類あり)</li>
</ul>

<h1>プッシュダウンオートマトンの一例</h1>
<ul>
  <li>a, b, c は言語の記号</li>
  <li>スタックは左が上で想定されている</li>
  <li>A/BA はスタックの一番上が A の場合に BA に変わる
    (つまり、B を上乗せ)</li>
</ul>

<p><img
alt="三スライド前の文法に相当するプッシュダウンオートマトンの図"
src="../../2005/Language Theory and Compilers/pushdown.png" /></p>

<h1>決定性と非決定性のプッシュダウンオートマトン</h1>
<ul>
  <li>S → aSa | bSb | c
    の文法の場合には決定性プッシュダウンオートマトンで実現可能</li>
  <li>S → aSa | bSb | ε
    の文法の場合には決定性プッシュダウンオートマトンで実現不可能。<br
    />
    なぜかというと語の真ん中の印がない。</li>
  <li>有限オートマトンと違って、決定性と非決定性のプッシュダウンオートマトンの性能
    (受理能力) が違う</li>
</ul>

<p>効率よく構文解析できるには可能な限り決定性のある文法が必要</p>

<h1>解析木と構文木</h1>
<dl>
  <dt>解析木:</dt>
    <dd>葉は終端記号と (分析の途中の場合) 被終端記号</dd>
    <dd>節は非終端記号</dd>
    <dd>文法や解析方法の研究に使われる</dd>
  <dt>構文木:</dt>
    <dd>葉は終端記号の一部 (識別子、定数など)</dd>
    <dd>節は被終端記号の一部に相当するが、終端記号の一部
      (演算子、予約語) などをラベルに使う</dd>
    <dd>一部の終端記号は無視 (特に括弧類)</dd>
</dl>

<h1>解析木と構文木の例</h1>

<p>文法:</p>

<p><code>E → E '+' E</code>    (Expression, 式)</p>

<p><code>E → E '*' E</code></p>

<p><code>E → '(' E ')'</code></p>

<p><code>E → integer</code></p>

<p>入力の例:</p>

<p><code>5 + 3 * (7 + 2)</code></p>

<h1>曖昧な文法</h1>
<ul>
  <li>例: <code>5 + 3 * 7</code> は <code>(5+3) * 7</code> か <code>5 +
    (3*7)</code> か</li>
  <li>文法が両方の解釈を許す</li>
  <li>ある入力に対して複数の解析木を許す文法は曖昧な文法
    (ambiguous grammar) と言う</li>
  <li>一部の文法の場合、変換によって曖昧性が取り除かれる</li>
  <li>変換のアルゴリズムや変換が可能かどうかを決めるアルゴリズムは存在しない</li>
  <li>曖昧な文法は言語の構文だけの定義には使えるが、プログラム言語やデータ形式には向いてない</li>
  <li>文法の曖昧性とプッシュダウンオートマトンの非決定性は同じものではない<br
    />
    (例: 左右対称の文字列)</li>
</ul>

<h1>文法の曖昧性の除去</h1>

<p>問題の例:</p>

<p><code>E → E '+' E | integer</code></p>

<p>入力 <code>4 + 5 + 7</code>
に対して複数の解析木が作れる</p>

<p>'+'
の場合には計算は同じ結果ですが、他の演算子の場合にはそうとも限らない</p>

<p>解決方法: 文法の書き換え</p>

<p><code>E → E '+' integer | integer</code></p>

<h1>解析の実装: 下向き解析と上向き解析</h1>
<dl>
  <dt>下向き構文解析 (top-down parsing):</dt>
    <dd>解析木を上から (初期記号から) 作る</dd>
  <dt>上向き構文解析 (bottom-up parsing):</dt>
    <dd>解析木をしたから (終端記号から) 作る</dd>
    <dd>途中に複数の (小さな) 解析木がある</dd>
</dl>

<h1>宿題</h1>

<p>提出: 6月16日 (金) 10:45 までに O 棟 529 号室の前; A4
一枚</p>

<p>次の文法の曖昧性を除去し、曖昧性のない文法を提出しなさい。曖昧性がないことを複数の例で確認してください。</p>

<p><code>E → E '+' E</code>    (Expression, 式)</p>

<p><code>E → E '*' E</code></p>

<p><code>E → '(' E ')'</code></p>

<p><code>E → integer</code></p>

<p>ヒント: 非終端記号の追加が必要</p>

<p></p>
</body>
</html>
